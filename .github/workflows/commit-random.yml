name: keep github-green 

on:
  schedule:
    - cron: '15 2,7,13 * * *'  # 北京时间 10:15 / 15:15 / 21:15
  workflow_dispatch: {}

permissions:
  contents: write

jobs:
  randomized-commits:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Run human-like commit generator
        env:
          REPO: ${{ github.repository }}
          GITHUB_ACTOR: ${{ github.actor }}
          ACTOR_NAME: ${{ secrets.ACTOR_NAME }}
          ACTOR_EMAIL: ${{ secrets.ACTOR_EMAIL }}
          PUSH_TOKEN: ${{ secrets.PUSH_TOKEN }}
          
          # 必须使用脚本能识别的变量名 
          SKIP_PROB: "0.1"                # 跳过概率
          MAX_COMMITS: "2"               # 每次运行最大提交数
          MIN_SLEEP: "1"                 # 提交间最短睡眠
          MAX_SLEEP: "5"                 # 提交间最长睡眠
          MAX_START_DELAY_MINUTES: "1"   # 启动延迟从默认 60 改为 1 分钟
          
        run: |
          chmod +x .github/scripts/random_commit.py
          python3 .github/scripts/random_commit.py
