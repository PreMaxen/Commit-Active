name: keep github-green 

on:
  schedule:
    - cron: '0 2,7,13 * * *'  # UTC → 北京时间 10:00/15:00/21:00
  workflow_dispatch: {}

permissions:
  contents: write

jobs:
  randomized-commits:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: Run human-like commit generator
        env:
          REPO: ${{ github.repository }}
          GITHUB_ACTOR: ${{ github.actor }}
          ACTOR_NAME: ${{ secrets.ACTOR_NAME }}
          ACTOR_EMAIL: ${{ secrets.ACTOR_EMAIL }}
          PUSH_TOKEN: ${{ secrets.PUSH_TOKEN }}

          # 可调参数
          DAILY_SKIP_PROB: "0.25"    # 当天直接跳过概率（更自然）
          COMMIT_SKIP_PROB: "0.15"   # 每次运行跳过概率
          MAX_COMMITS: "4"
          MIN_SLEEP: "10"
          MAX_SLEEP: "180"
          START_DELAY_MIN: "3"
          START_DELAY_MAX: "180"
        run: |
          chmod +x .github/scripts/random_commit.py
          python3 .github/scripts/random_commit.py
